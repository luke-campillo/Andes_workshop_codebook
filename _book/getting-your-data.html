<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Getting your data | Andes Phylogenomics Workshop</title>
  <meta name="description" content="Step-by-step guide to a basic project in phylogenomics." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Getting your data | Andes Phylogenomics Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Step-by-step guide to a basic project in phylogenomics." />
  <meta name="github-repo" content="rachelss/Andes_workshop_codebook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Getting your data | Andes Phylogenomics Workshop" />
  
  <meta name="twitter:description" content="Step-by-step guide to a basic project in phylogenomics." />
  

<meta name="author" content="Rachel Schwartz" />


<meta name="date" content="2023-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="computational-skills.html"/>
<link rel="next" href="plastome-variation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Andes Phylogenomics Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="genomic-data.html"><a href="genomic-data.html"><i class="fa fa-check"></i><b>3</b> Genomic data</a></li>
<li class="chapter" data-level="4" data-path="computational-skills.html"><a href="computational-skills.html"><i class="fa fa-check"></i><b>4</b> Computational skills</a>
<ul>
<li class="chapter" data-level="4.1" data-path="computational-skills.html"><a href="computational-skills.html#log-in-to-the-server"><i class="fa fa-check"></i><b>4.1</b> Log in to the server</a></li>
<li class="chapter" data-level="4.2" data-path="computational-skills.html"><a href="computational-skills.html#basic-navigation"><i class="fa fa-check"></i><b>4.2</b> Basic navigation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="getting-your-data.html"><a href="getting-your-data.html"><i class="fa fa-check"></i><b>5</b> Getting your data</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="getting-your-data.html"><a href="getting-your-data.html#repeating-analyses"><i class="fa fa-check"></i><b>5.0.1</b> Repeating analyses</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plastome-variation.html"><a href="plastome-variation.html"><i class="fa fa-check"></i><b>6</b> Plastome variation</a></li>
<li class="chapter" data-level="7" data-path="variant-calling.html"><a href="variant-calling.html"><i class="fa fa-check"></i><b>7</b> Variant Calling</a></li>
<li class="chapter" data-level="8" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>8</b> Results</a>
<ul>
<li class="chapter" data-level="8.1" data-path="results.html"><a href="results.html#what-does-your-tree-tell-you"><i class="fa fa-check"></i><b>8.1</b> What does your tree tell you?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sharing-your-results.html"><a href="sharing-your-results.html"><i class="fa fa-check"></i><b>9</b> Sharing your results</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sharing-your-results.html"><a href="sharing-your-results.html#presentation"><i class="fa fa-check"></i><b>9.1</b> Presentation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Andes Phylogenomics Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="getting-your-data" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Getting your data<a href="getting-your-data.html#getting-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For this workshop we will be using genome sequence data from a group of Andean plants.
For starters we will take a peak at these data so you know what it looks like before we use standard programs to analyze it.</p>
<p>The sequence data is in a shared folder on this server.
Relative to your home folder you can find the data at
<code>../shared/Andes_plants/</code>.</p>
<p>If you cd to that directory and list the contents you can see folders containing files of data.</p>
<p>There are sequence files for 40 individuals grouped into four folders, one for each group, as well as a folder of chloroplast data.
Start by going to the folder for your assigned group and listing its contents.</p>
<p>You do not want to view these files because they are very large.
If you want to see how large use <code>ls -lh</code>.
You are already familiar with the <code>ls</code> command for listing the contents of folders.
The dash followed by additional letters are called flags.
The <code>l</code> flag indicates that we are listing the contents in long form to provide additional information.
The <code>h</code> flag means we’ll view the data in human readable format (i.e. with size given in Mb).</p>
<p>Raw data is in the form of zipped fastq files, which are generated by a sequencer.
You can tell this by the very last bit of the name of the files, which is .fastq.gz (just like you might see Word files labeled as .docx).
Just as a note, you often need to do some cleanup of the data that comes of the sequencer
so you only have high quality data.
We have done this step for you already.
Take a look at a little bit of one file.
The <code>less</code> command lets you scroll through the (very large) file.
<code>zless</code> is the <code>less</code> command that works on zipped files.</p>
<p>Fastq files contain sets of four lines.
The first line is the name of the sequence.
The second line is the sequence.
The fourth line is the quality of the sequence.
As you scroll through you should see many sets of four (one for each sequence).</p>
<pre><code>zless [].fastq.gz</code></pre>
<p>Once you are done scrolling use q (for quit) to get back to your prompt.</p>
<p>Before we look at our large files we are going to practice on a small example file.
Move back to the main <code>Andes_plants</code> folder.
List the contents and notice the <code>example.fastq</code> file.
For this example I have unzipped it.
You can view the entire contents of the file using the command <code>cat</code>.</p>
<pre><code>cat example.fastq</code></pre>
<p>Alternatively you can use the command <code>head</code> to view the first few lines of the file.</p>
<pre><code>head example.fastq</code></pre>
<p>We can also get a sense of the amount of data by counting the number of lines using the word count command <code>wc</code>.</p>
<pre><code>wc example.fastq</code></pre>
<p>This command tells you the number of lines, words, and characters. If you want to focus just on the number of lines you should use the <code>l</code> flag.</p>
<pre><code>wc -l example.fastq</code></pre>
<p>If we only want to get the names of the sequences we can search for lines that match a particular pattern and print just those. We search with the command <code>grep</code>. The pattern we are searching for is lines that start with @. And then we provide the name of the file.</p>
<pre><code>grep &#39;^@&#39; example.fastq</code></pre>
<p>Because this is a small example file we are able to print all the header lines without it being overwhelming. However, with our larger files we don’t want to do this. However, we know that the <code>head</code> command allows us to view just the first few lines of our output. Now we’ll combine those two commands using a pipe (<code>|</code>). First we enter the <code>grep</code> command (with it’s two arguments) then we “pipe” the output to the <code>head</code> command rather than printing it to the screen.</p>
<pre><code>grep &#39;^@&#39; example.fastq |  head</code></pre>
<p>Notice that the <code>head</code> command does not have arguments in this case because it accepts the output from the grep command.</p>
<p>The <code>head</code> command accepts a flag with the number of lines you want to print.
For example <code>head -4</code> will print the first four lines.</p>
<p>Your first challenge in this course is to combine the information that you have learned to get the number of header lines in one of your zipped fastq files (using <code>zgrep</code>).</p>
<div id="repeating-analyses" class="section level3 hasAnchor" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> Repeating analyses<a href="getting-your-data.html#repeating-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One approach to analyzing multiple files in the same way is to copy your code and edit each copy to include the name of a particular file. That might be feasible (if slow) for the 10 files you are working with here, but it is inconvenient for the many files you might work with on a larger genomics project. Instead, we can make a list of the files we want to work with and tell the computer to repeat the analysis on each file.</p>
<p>In the prior challenge you figured out what analysis you want to do (list the number of header lines). Now we need to learn how to repeat this. In most programming languages, including our command line, we use a loop to go through a list and repeat that command. On the command line the format to do this looks like</p>
<pre><code>for thing in list_of_things
do
    command $thing
done</code></pre>
<p>We start with <code>for</code> to indicate that we are about to make a loop.
Each time the loop runs (called an iteration), an item in the list is assigned in sequence to the variable <code>thing</code>, and the commands inside the loop are executed.
Think of a variable as a box that holds the item we are working with.
For example, if we are working with a list of files then the first time
through the loop <code>thing</code> is the first file name in the list,
the second time through <code>thing</code> is the second name, and so on.
This allows us to repeat our command for each item in the list using the same variable name.
Inside the loop, we indicate the variable by putting <code>$</code> in front of it.
The <code>$</code> tells the shell interpreter to treat the variable as a variable name and substitute its value in its place, rather than treat it as text or an external command.</p>
<ul>
<li>Start by figuring out what goes on the third line of the loop</li>
<li>Now figure out what goes on the first line (i.e. your list)</li>
<li>When you run your loop it should print the number of header lines for each file</li>
</ul>
<p>We might want to add one command to this loop to print out the name of the file prior to printing the number of header lines so we can more easily keep track of each file’s information. The <code>echo</code> command will print whatever comes after it. Try inserting this command into your loop in order to print the name of the file following by the number of header lines.</p>
<p>Did you need to list all your files by hand? Copying and pasting a lot of names can be time consuming and error prone. Logically, you want to make your list following a particular rule, for example all of the files in this folder. We can use a wildcard (denoted <code>*</code>) to do this. So instead of writing out all the file names, replace all of that just with <code>*</code> as your list.
In other situations keep in mind that we might want to be more precise.
<code>*</code> really suggests any number of any character.
To indicate all files that end in <code>fastq.gz</code> we could use <code>*fastq.gz</code> as our list.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="computational-skills.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plastome-variation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
